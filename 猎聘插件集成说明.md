# 猎聘插件集成说明

## 概述

本系统现已支持猎聘Chrome插件的JSON输出格式，可以自动识别并解析插件导出的简历数据。

## 支持的格式

### 1. 猎聘插件格式
- 插件导出的JSON文件（数组格式）
- 包含10个主要信息类别
- 自动识别并映射到数据库

### 2. 标准格式
- 原有的标准JSON格式
- 包含基本信息、联系方式、工作经历等

## 使用方法

### 1. 使用猎聘插件提取数据

1. **安装Chrome插件**
   - 下载 `chrome-plugin` 文件夹
   - 在Chrome中加载已解压的扩展程序
   - 访问猎聘网站

2. **提取简历数据**
   - 在猎聘简历页面使用悬浮面板
   - 点击"📊 提取简历数据"
   - 点击"📥 导出JSON"下载文件

3. **上传到系统**
   - 在前端页面选择"上传简历"
   - 上传插件导出的JSON文件
   - 系统会自动识别格式并解析

### 2. 数据映射说明

#### 基本信息映射
- `姓名` → `chinese_name`
- `性别` → `gender`
- `年龄` → `birth_date` (自动计算)
- `工作年限` → `summary_total_years`
- `现居地` → `current_city`

#### 求职意向映射
- `期望职位` → `expected_position`
- `期望城市` → `expected_cities`
- `期望薪资` → `expected_salary_monthly`

#### 工作经历映射
- `公司名称` → `company_name`
- `职位名称` → `position`
- `工作时间` → `start_date`, `end_date`
- `职责业绩` → `job_description`
- `企业信息` → `company_type`
- `所属行业` → `company_stage`

#### 教育经历映射
- `学校名称` → `school`
- `专业名称` → `major`
- `学位` → `degree`
- `就读时间` → `start_date`, `end_date`

#### 项目经历映射
- `项目名称` → `project_name`
- `项目职务` → `role`
- `项目时间` → `start_date`, `end_date`
- `项目描述` → `project_intro`
- `项目业绩` → `project_achievements`

#### 技能和语言映射
- `技能标签` → `skills`
- `语言能力` → `languages`
- `自我评价` → `ai_profile`

## API接口

### 上传简历
```
POST /api/resume/upload
```

**请求参数：**
- `resume_file`: JSON文件
- `path`: 存储路径（可选，默认为"resumes/"）

**响应示例：**
```json
{
  "success": true,
  "message": "简历上传成功 (猎聘插件格式)",
  "resume_id": 1,
  "filename": "猎聘简历数据_2024-01-01.json",
  "oss_url": "https://...",
  "object_name": "resumes/20240101_120000_猎聘简历数据_2024-01-01.json",
  "format_type": "liepin_plugin",
  "work_experiences_count": 1,
  "education_experiences_count": 1,
  "project_experiences_count": 1
}
```

### 获取简历列表
```
GET /api/resume/list?page=1&page_size=10&search=张三
```

### 获取简历详情
```
GET /api/resume/{resume_id}
```

## 测试文件

- `sample_liepin_resume.json`: 示例猎聘插件格式文件
- `test_liepin_mapper.py`: 映射功能测试脚本

## 运行测试

```bash
python test_liepin_mapper.py
```

## 注意事项

1. **格式自动识别**：系统会自动检测JSON格式，无需手动指定
2. **数据完整性**：插件提取的数据会完整映射到数据库
3. **时间格式**：支持"2020.03-至今"等时间格式的自动解析
4. **错误处理**：格式错误或映射失败会返回详细错误信息

## 技术实现

### 映射器类
- `ResumeMapper.map_liepin_plugin_data()`: 映射基本信息
- `ResumeMapper.map_liepin_work_experiences()`: 映射工作经历
- `ResumeMapper.map_liepin_education_experiences()`: 映射教育经历
- `ResumeMapper.map_liepin_project_experiences()`: 映射项目经历

### 格式检测
系统通过检查JSON结构中的特征字段来自动识别格式：
- 猎聘插件格式：包含 `0.总体信息`, `1.基本信息` 等字段
- 标准格式：包含 `basic_info`, `contact_info` 等字段

## 更新日志

- **v1.0**: 支持猎聘插件JSON格式
- **v1.1**: 添加格式自动检测功能
- **v1.2**: 完善数据映射和错误处理 